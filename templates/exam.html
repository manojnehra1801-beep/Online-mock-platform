<script>
/* ================= STEP-2 SECURITY ================= */

let violations = 0;
const MAX_VIOLATIONS = 2;

/* ---- Fullscreen ---- */
function enterFullscreen() {
    const el = document.documentElement;
    if (el.requestFullscreen) el.requestFullscreen();
    else if (el.webkitRequestFullscreen) el.webkitRequestFullscreen();
}
enterFullscreen();

/* ---- Visibility / Minimize Detect ---- */
document.addEventListener("visibilitychange", () => {
    if (document.hidden) {
        violations++;
        alert("⚠️ Do not minimize or switch apps!");
        checkViolation();
    }
});

/* ---- Back Button Block ---- */
history.pushState(null, null, location.href);
window.onpopstate = function () {
    history.go(1);
    violations++;
    alert("⚠️ Back button is disabled during exam");
    checkViolation();
};

/* ---- Violation Check ---- */
function checkViolation(){
    if(violations >= MAX_VIOLATIONS){
        alert("❌ Exam terminated due to multiple violations");
        document.getElementById("examForm").submit();
    }
}
</script>